# Dokumentasi API & Endpoints

Dokumentasi ini menjelaskan endpoints yang tersedia untuk ketiga role dalam aplikasi.

> **Note**: Aplikasi ini menggunakan arsitektur Hybrid.
> *   **Guest**: Menggunakan **REST/AJAX API** untuk interaksi keranjang dan peminjaman tanpa reload.
> *   **Pengelola & Pengurus**: Menggunakan **Livewire (Internal API)** untuk interaksi real-time server-side.

---

## 1. Guest API (Public)

API ini digunakan oleh halaman publik (frontend) untuk fitur Keranjang dan Booking.

### Base URL: `/api`

### A. Cart (Keranjang) - Session Based
Mengelola item dalam keranjang belanja user.

| Method | Endpoint | Deskripsi | Payload |
| :--- | :--- | :--- | :--- |
| `GET` | `/cart` | Ambil isi keranjang | - |
| `POST` | `/cart/add` | Tambah item | `{"name": "...", "type": "...", "quantity": 1}` |
| `POST` | `/cart/update` | Update jumlah | `{"name": "...", "type": "...", "quantity": 5}` |
| `POST` | `/cart/clear` | Kosongkan keranjang | - |

### B. Loan / Peminjaman
Menangani validasi dan submit peminjaman.

| Method | Endpoint | Deskripsi | Query / Body |
| :--- | :--- | :--- | :--- |
| `GET` | `/peminjaman` | Public Calendar Data | `?date=YYYY-MM-DD` |
| `GET` | `/peminjaman/check` | Cek Stok Tersedia | `?startDate=...&endDate=...` |
| `POST` | `/peminjaman` | **Submit Booking** | Multipart Form (file, ktp, items, user data) |

---

## 2. Pengelola Endpoints (Admin)

Role Pengelola menggunakan interface berbasis Livewire. Tidak ada REST API publik, namun terdapat endpoint khusus untuk utilitas.

### A. Laporan Export
Endpoint untuk mengunduh laporan rekapitulasi peminjaman.

*   **URL**: `/pengelola/laporan/export/{format}`
*   **Method**: `GET`
*   **Auth**: `Sanctum/Session` (Requires Login as Pengelola)
*   **Parameters**:
    *   `format`: `xlsx` | `csv` | `pdf`
    *   `from`, `to`: Rentang Tanggal (YYYY-MM-DD)
    *   `kategori`: `all` | `barang` | `ruangan`
    *   `status`: `all` | `completed` | etc.

### B. Internal Actions (Livewire)
Aksi berikut dijalankan via WebSocket/AJAX internal Livewire:
*   **Approval**: `approve($id)`, `reject($id)`
*   **Inventory**: `store()`, `update()`, `destroy($id)`

---

## 3. Pengurus Endpoints (Operasional)

Role Pengurus fokus pada operasional harian menggunakan Livewire Components.

### A. Operational Actions (Livewire)
Endpoint ini bersifat internal dan dipanggil oleh komponen UI `PeminjamanFasilitas`.

*   **Toggle Status** (Ambil/Kembali)
    *   **Component**: `App\Livewire\Pengurus\PeminjamanFasilitas`
    *   **Method**: `toggleStatus($id, $type)`
    *   **Deskripsi**: Mengubah status item menjadi "Sudah Diambil" atau "Sudah Kembali".
    *   **Trigger**: Checkbox pada tabel dashboard operasional.

### B. Dashboard Data
Data dashboard dilayani langsung via HTML Render, bukan JSON.
*   **URL**: `/pengurusinventoryMSU/dashboard`
*   **Data**: List barang yang harus disiapkan hari ini.
